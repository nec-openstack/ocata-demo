ALERT ContainerQuantityOver
  IF sum(container_tasks_state{state='running',image!=''}+1)/sum(up{job='node'}) > 5
  FOR 20s
  LABELS {}
  ANNOTATIONS {
    summary = "High Memory usage for a container",
    description = "High Memory usage on {{$labels.instance}} for container {{$labels.name}} (current value: {{$value}})"
  }

ALERT ContainerIdle
  IF sum(container_tasks_state{state='running',image!=''}+1)/sum(up{job='node'}) < 5
  FOR 20s
  ANNOTATIONS {
    summary = "Too many resources wasted",
    description = "Too much memory {{$labels.instance}} for container {{$labels.name}} (current value: {{$value}})"
  }

# sum((node_memory_MemTotal - node_memory_MemFree) / 1024 / 1024) / sum(up{job="node"})
