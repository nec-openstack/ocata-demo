ALERT HighMemoryAlert
  IF sum(node_memory_MemFree / 1024 / 1024) < 150
  FOR 1m
  LABELS {action = "scale-out"}
  ANNOTATIONS {
    summary = "High Memory usage for a container",
    description = "High Memory usage on {{$labels.instance}} for container {{$labels.name}} (current value: {{$value}})"
  }

ALERT LowMemoryAlert
  IF sum(node_memory_MemFree / 1024 / 1024) > 500
  FOR 1m
  LABELS {action = "scale-in"}
  ANNOTATIONS {
    summary = "High Memory usage for a container",
    description = "Low memory {{$labels.instance}} for container {{$labels.name}} (current value: {{$value}})"
  }

ALERT MissingJob
  If up < 1
  FOR 20s

# sum((node_memory_MemTotal - node_memory_MemFree) / 1024 / 1024) / sum(up{job="node"})
